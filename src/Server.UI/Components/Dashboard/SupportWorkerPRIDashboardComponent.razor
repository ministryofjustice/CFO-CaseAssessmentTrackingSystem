@using Cfo.Cats.Application.Features.Dashboard.Queries
@using ApexCharts
@inherits CatsComponent<GetPrisPerSupportWorker.PrisPerSupportWorkerDto>

@if (Loading)
{
    <MudLoading Text="Loading" />
}
@if (ErrorMessage is not null)
{
    <MudAlert Variant="Variant.Outlined" Severity="Severity.Error">
        @ErrorMessage
    </MudAlert>
}
@if (Data is not null)
{
    <MudGrid Spacing="2">
        <!-- Pre-Release Support - Eligible for Payment -->
        <MudItem xs="12" sm="6" md="6" lg="6" Style="height: calc(50vh - 100px);">
            <MudCard Style="height: 100%;">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">Pre-Release Support - Eligible for Payment</MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent Style="height: calc(100% - 80px); overflow:auto;">
                    @if (VisualMode)
                    {
                        <div style="width: 100%; height: 100%;">
                            @if (GetChartData(ConstantString.PreReleaseSupport, true).Any())
                            {
                                <ApexChart TItem="ChartDataPoint"
                                           Options="@GetChartOptions("#10b981")" Height="350">
                                    <ApexPointSeries TItem="ChartDataPoint"
                                                     Items="@GetChartData(ConstantString.PreReleaseSupport, true)"
                                                     Name="Count"
                                                     SeriesType="SeriesType.Bar"
                                                     XValue="@(e => e.Location)"
                                                     YValue="@(e => (decimal)e.Count)"
                                                     OrderBy="e => e.X"/>
                                </ApexChart>
                            }
                            else
                            {
                                <MudText Typo="Typo.body2" Color="Color.Secondary" Align="MudBlazor.Align.Center">No data available</MudText>
                            }
                        </div>
                    }
                    else
                    {
                        <MudTable Items="@GetTableData(ConstantString.PreReleaseSupport, true)" MultiSelection="false" Striped="true" Hover="true">
                            <HeaderContent>
                                <MudTh>Location</MudTh>
                                <MudTh>Count</MudTh>
                            </HeaderContent>
                            <RowTemplate>
                                <MudTd>@context.Name</MudTd>
                                <MudTd>@context.Count</MudTd>
                            </RowTemplate>
                            <PagerContent>
                                <MudTablePager PageSizeOptions="new int[] { 10, 20 }" />
                            </PagerContent>
                        </MudTable>
                    }
                </MudCardContent>
            </MudCard>
        </MudItem>

        <!-- Pre-Release Support - NOT Eligible for Payment -->
        <MudItem xs="12" sm="6" md="6" lg="6" Style="height: calc(50vh - 100px);">
            <MudCard Style="height: 100%;">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">Pre-Release Support - NOT Eligible for Payment</MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent Style="height: calc(100% - 80px);">
                    @if (VisualMode)
                    {
                        <div style="width: 100%; height: 100%;">
                            @if (GetChartData(ConstantString.PreReleaseSupport, false).Any())
                            {
                                <ApexChart TItem="ChartDataPoint"
                                           Options="@GetChartOptions("#ef4444")" Height="350">
                                    <ApexPointSeries TItem="ChartDataPoint"
                                                     Items="@GetChartData(ConstantString.PreReleaseSupport, false)"
                                                     Name="Count"
                                                     SeriesType="SeriesType.Bar"
                                                     XValue="@(e => e.Location)"
                                                     YValue="@(e => (decimal)e.Count)"
                                                     OrderBy="e => e.X" />
                                </ApexChart>
                            }
                            else
                            {
                                <MudText Typo="Typo.body2" Color="Color.Secondary" Align="MudBlazor.Align.Center">No data available</MudText>
                            }
                        </div>
                    }
                    else
                    {
                        <MudTable Items="@GetTableData(ConstantString.PreReleaseSupport, false)" MultiSelection="false" Striped="true" Hover="true">
                            <HeaderContent>
                                <MudTh>Location</MudTh>
                                <MudTh>Count</MudTh>
                            </HeaderContent>
                            <RowTemplate>
                                <MudTd>@context.Name</MudTd>
                                <MudTd>@context.Count</MudTd>
                            </RowTemplate>
                            <PagerContent>
                                <MudTablePager PageSizeOptions="new int[] { 10, 20 }" />
                            </PagerContent>
                        </MudTable>
                    }
                </MudCardContent>
            </MudCard>
        </MudItem>

        <!-- Through the Gate - Eligible for Payment -->
        <MudItem xs="12" sm="6" md="6" lg="6" Style="height: calc(50vh - 100px);">
            <MudCard Style="height: 100%;">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">Through the Gate - Eligible for Payment</MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent Style="height: calc(100% - 80px);">
                    @if (VisualMode)
                    {
                        <div style="width: 100%; height: 100%;">
                            @if (GetChartData(ConstantString.ThroughTheGate, true).Any())
                            {
                                <ApexChart TItem="ChartDataPoint"
                                           Options="@GetChartOptions("#3b82f6")" Height="350">
                                    <ApexPointSeries TItem="ChartDataPoint"
                                                     Items="@GetChartData(ConstantString.ThroughTheGate, true)"
                                                     Name="Count"
                                                     SeriesType="SeriesType.Bar"
                                                     XValue="@(e => e.Location)"
                                                     YValue="@(e => (decimal)e.Count)"
                                                     OrderBy="e => e.X" />
                                </ApexChart>
                            }
                            else
                            {
                                <MudText Typo="Typo.body2" Color="Color.Secondary" Align="MudBlazor.Align.Center">No data available</MudText>
                            }
                        </div>
                    }
                    else
                    {
                        <MudTable Items="@GetTableData(ConstantString.ThroughTheGate, true)" MultiSelection="false" Striped="true" Hover="true">
                            <HeaderContent>
                                <MudTh>Location</MudTh>
                                <MudTh>Count</MudTh>
                            </HeaderContent>
                            <RowTemplate>
                                <MudTd>@context.Name</MudTd>
                                <MudTd>@context.Count</MudTd>
                            </RowTemplate>
                            <PagerContent>
                                <MudTablePager PageSizeOptions="new int[] { 10, 20 }" />
                            </PagerContent>
                        </MudTable>
                    }
                </MudCardContent>
            </MudCard>
        </MudItem>

        <!-- Through the Gate - NOT Eligible for Payment -->
        <MudItem xs="12" sm="6" md="6" lg="6" Style="height: calc(50vh - 100px);">
            <MudCard Style="height: 100%;">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h6">Through the Gate - NOT Eligible for Payment</MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardContent Style="height: calc(100% - 80px);">
                    @if (VisualMode)
                    {
                        <div style="width: 100%; height: 100%;">
                            @if (GetChartData(ConstantString.ThroughTheGate, false).Any())
                            {
                                <ApexChart TItem="ChartDataPoint"
                                           Options="@GetChartOptions("#f59e0b")" Height="350">
                                    <ApexPointSeries TItem="ChartDataPoint"
                                                     Items="@GetChartData(ConstantString.ThroughTheGate, false)"
                                                     Name="Count"
                                                     SeriesType="SeriesType.Bar"
                                                     XValue="@(e => e.Location)"
                                                     YValue="@(e => (decimal)e.Count)"
                                                     OrderBy="e => e.X" />
                                </ApexChart>
                            }
                            else
                            {
                                <MudText Typo="Typo.body2" Color="Color.Secondary" Align="MudBlazor.Align.Center">No data available</MudText>
                            }
                        </div>
                    }
                    else
                    {
                        <MudTable Items="@GetTableData(ConstantString.ThroughTheGate, false)" MultiSelection="false" Hover="true" Striped="true">
                            <HeaderContent>
                                <MudTh>Location</MudTh>
                                <MudTh>Count</MudTh>
                            </HeaderContent>
                            <RowTemplate>
                                <MudTd>@context.Name</MudTd>
                                <MudTd>@context.Count</MudTd>
                            </RowTemplate>
                            <PagerContent>
                                <MudTablePager PageSizeOptions="new int[] { 10, 20 }" />
                            </PagerContent>
                        </MudTable>
                    }
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>
}


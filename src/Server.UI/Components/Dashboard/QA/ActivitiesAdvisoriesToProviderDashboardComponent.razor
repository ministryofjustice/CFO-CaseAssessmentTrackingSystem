@using Cfo.Cats.Application.Features.Dashboard.Queries
@using Cfo.Cats.Domain.Common.Enums
@inherits CatsComponent<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesToProviderDto>

@if(Loading)
{
	<MudLoading Text="Loading" />
}

@if (ErrorMessage is not null)
{
	<MudAlert Variant="Variant.Outlined" Severity="Severity.Error">
		@ErrorMessage
	</MudAlert>
}

@if (Data is not null && Data.ChartData.Any())
{
	@if (VisualMode)
	{
		<MudText Typo="Typo.h6" Class="mb-2 mt-2">Employment</MudText>
        <ApexCharts.ApexChart TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                      Options="Options"
                      Height="400" Width="@( "100%" )">

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.Employment && x.Queue == "Escalation")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="Escalation"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.Employment && x.Queue == "QA2")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="QA2"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

		</ApexCharts.ApexChart>

		<MudText Typo="Typo.h6" Class="mb-2 mt-4">Education and Training</MudText>
        <ApexCharts.ApexChart TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                      Options="Options"
                      Height="400" Width="@( "100%" )">

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.EducationAndTraining && x.Queue == "Escalation")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="Escalation"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.EducationAndTraining && x.Queue == "QA2")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="QA2"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

		</ApexCharts.ApexChart>

		<MudText Typo="Typo.h6" Class="mb-2 mt-4">ISW</MudText>
        <ApexCharts.ApexChart TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                      Options="Options"
                      Height="400" Width="@( "100%" )">

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.InterventionsAndServicesWraparoundSupport && x.Queue == "Escalation")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="Escalation"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

            <ApexCharts.ApexPointSeries TItem="GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesChartData"
                                        Items='Data.ChartData.Where(x => x.ActivityType == ActivityType.SupportWork && x.Queue == "QA2")'
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="QA2"
                                        XValue="@(e => e.ContractName)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />

		</ApexCharts.ApexChart>
	}
	else
	{
		<MudTable Items="@Data.TabularData" MultiSelection="false" Striped="true" Hover="true">
			<HeaderContent>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.ContractName!)">
                        Contract
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.Queue!)">
                        Queue
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.ActivityType!.Name)">
                        Activity Type
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.ParticipantId!)">
                        Participant
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.SupportWorker!)">
                        Support Worker
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.PqaUser!)">
                        Provider QA
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.CfoUser!)">
                        CFO USER
                    </MudTableSortLabel>
                </MudTh>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.PqaSubmittedDate!)">
                        PQA Submitted Date
                    </MudTableSortLabel>
                </MudTh>
				<MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.AdvisoryDate!)">
                        Advisory Date
                    </MudTableSortLabel>
                </MudTh>				
				<MudTh>
                    <MudTableSortLabel SortBy="new Func<GetActivitiesAdvisoriesToProvider.ActivitiesAdvisoriesTabularData, object>(x => x.Message!)">
                        Message
                    </MudTableSortLabel>
                </MudTh>		
			</HeaderContent>
			<RowTemplate>
                <MudTd DataLabel="Contract">@context.ContractName</MudTd>
				<MudTd DataLabel="Queue">@context.Queue</MudTd>
				<MudTd DataLabel="Activity Type">@context.ActivityType?.Name</MudTd>
				<MudTd DataLabel="Participant">@context.ParticipantId</MudTd>
				<MudTd DataLabel="Support Worker">@context.SupportWorker</MudTd>
				<MudTd DataLabel="Provider QA">@context.PqaUser</MudTd>
				<MudTd DataLabel="Cfo User">@context.CfoUser</MudTd>
				<MudTd DataLabel="PQA Submitted Date">@context.PqaSubmittedDate</MudTd>
				<MudTd DataLabel="Advisory Date">@context.AdvisoryDate</MudTd>
				<MudTd DataLabel="Message">@context.Message</MudTd>
			</RowTemplate>
			<PagerContent>
				<MudTablePager PageSizeOptions="new int[] { 10, 20, 30 }" />
			</PagerContent>
		</MudTable>
	}

}
else
{
    <MudText Typo="Typo.body2" Color="Color.Secondary" Align="MudBlazor.Align.Center">No data available</MudText>
}

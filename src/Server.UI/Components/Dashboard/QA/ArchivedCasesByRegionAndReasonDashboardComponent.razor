@using Cfo.Cats.Application.Features.Dashboard.Queries
@inherits CatsComponent<GetArchivedCasesByRegionAndReason.ArchivedCasesByRegionAndReasonDto>

@if (Loading)
{
    <MudLoading Text="Loading" />
}

@if (ErrorMessage is not null)
{
    <MudAlert Variant="Variant.Outlined" Severity="Severity.Error">
        @ErrorMessage
    </MudAlert>
}

@if (Data is not null && Data.ChartData.Any())
{
    if (VisualMode)
    {
        <ApexCharts.ApexChart TItem="GetArchivedCasesByRegionAndReason.ArchivedCasesChartData"
                              Options="@Options"
                              Height="650" Width="@( "100%" )">


            <ApexCharts.ApexPointSeries TItem="GetArchivedCasesByRegionAndReason.ArchivedCasesChartData"
                                        Items="Data.ChartData"
                                        SeriesType="ApexCharts.SeriesType.Bar"
                                        Name="Archived Cases"
                                        XValue="@(e => e.Region)"
                                        YValue="@(e => e.Count)"
                                        ShowDataLabels="true" />
        </ApexCharts.ApexChart>
    }
    else
    {
        <MudTable Items="@Data.TabularData" MultiSelection="false" Striped="true" Hover="true">
            <HeaderContent>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.ContractId!)">
                        Contract
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.Region!)">
                        Region
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.Reason!)">
                        Reason
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.ParticipantId!)">
                        Participant
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.Created)">
                        Created
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.From)">
                        From
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    <MudTableSortLabel SortBy="new Func<GetArchivedCasesByRegionAndReason.ArchivedCasesTabularData, object>(x => x.To!)">
                        To
                    </MudTableSortLabel>
                </MudTh>

                <MudTh>
                    Created By
                </MudTh>
            </HeaderContent>

            <RowTemplate>
                <MudTd DataLabel="Contract">@context.ContractId</MudTd>
                <MudTd DataLabel="Region">@context.Region</MudTd>
                <MudTd DataLabel="Reason">@context.Reason</MudTd>
                <MudTd DataLabel="Participant">@context.ParticipantId</MudTd>
                <MudTd DataLabel="Created">@context.Created</MudTd>
                <MudTd DataLabel="From">@context.From</MudTd>
                <MudTd DataLabel="To">@context.To</MudTd>
                <MudTd DataLabel="Created By">@context.CreatedBy</MudTd>
            </RowTemplate>

            <PagerContent>
                <MudTablePager PageSizeOptions="new int[] { 10, 20 }" />
            </PagerContent>
        </MudTable>
    }
}
else
{
    <MudText Typo="Typo.body2"
             Color="Color.Secondary"
             Align="MudBlazor.Align.Center">
        No data available
    </MudText>
}
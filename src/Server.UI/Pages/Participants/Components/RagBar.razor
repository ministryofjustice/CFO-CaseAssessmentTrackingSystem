@using Cfo.Cats.Application.Features.Assessments.DTOs
@using Cfo.Cats.Application.Features.Assessments.Queries
@using Cfo.Cats.Domain.Common.Enums

<MudPaper Class="ma-2 d-flex justify-space-between flex-wrap" Elevation="1" Outlined="true">
    @if (_model is not null)
    {
        foreach (var pathway in _model.PathwayScore)
        {
            <RagComponent Pathway="pathway"></RagComponent>
        }
    }
</MudPaper>

@code {

    private ParticipantAssessmentDto? _model = null;
    
    [Parameter]
    [EditorRequired]
    public string ParticipantId { get; set; } = default!;

    protected override async Task OnParametersSetAsync()
    {
        var query = new GetAssessmentScores.Query()
        {
            ParticipantId = ParticipantId
        };
        var result = await Mediator.Send(query);
        if (result.Succeeded)
        {
            _model = result.Data!.MaxBy(pa => pa.CreatedDate);
        }
    }

}

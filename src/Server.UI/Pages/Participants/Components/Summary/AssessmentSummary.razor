@inherits CatsComponentBase

<MudCard Style="Height: 100%;">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">Latest Assessment</MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent>

        @if (_latestAssessment is null)
        {
            <MudText Typo="Typo.body2">@_noAssessmentInfo</MudText>
        }
        else
        {
            <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
                <MudText><strong>Date Created</strong></MudText>
                <MudText>@_latestAssessment.AssessmentDate!.Value.ToString("dd/MM/yyyy")</MudText>
            </MudStack>

            <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
                <MudText><strong>Created By</strong></MudText>
                <MudText>@UserService.DataSource.First(u => u.Id == _latestAssessment.AssessmentCreator).DisplayName</MudText>
            </MudStack>

            @if (_latestAssessment.Completed.HasValue)
            {
                <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
                    <MudText><strong>Date Completed</strong></MudText>
                    <MudText>@_latestAssessment.Completed!.Value.ToString("dd/MM/yyyy")</MudText>
                </MudStack>
                <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
                    <MudText><strong>Due</strong></MudText>
                    <MudTooltip Text="@_assessmentDueTooltipText">
                        <MudIcon Icon="@_assessmentDueIcon" Size="@Size.Small" Color="@_assessmentDueIconColor" Class="mr-2" />
                        <MudText Typo="Typo.body2">
                            @_assessmentDueInfo
                        </MudText>
                    </MudTooltip>
                </MudStack>
            }
            else
            {
                <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
                    <MudTooltip Text="@_AssessmentNotCompletedInfo">
                        <MudIcon Icon="@_assessmentDueIcon" Size="@Size.Small" Color="@_assessmentDueIconColor" Class="mr-2" />
                        <MudText>
                            @_AssessmentNotCompletedInfo
                        </MudText>
                    </MudTooltip>
                </MudStack>
            }
        }
    </MudCardContent>
    <MudCardActions>
        <MudStack Row="true" StretchItems="StretchItems.Start" Class="mb-2">
            @if (CanBeginAssessment())
            {
                <MudTooltip Text="Create Assessment">
                    <MudIconButton Color="Color.Primary" Icon="@Icons.Material.Filled.Add" Variant="Variant.Outlined" OnClick="BeginAssessment" />
                </MudTooltip>
            }

            @if (CanContinueAssessment())
            {
                <MudTooltip Text="Continue Assessment">
                    <MudIconButton Color="Color.Primary" Icon="@Icons.Material.Filled.ChevronRight" Variant="Variant.Outlined" OnClick="ContinueAssessment" />
                </MudTooltip>
            }

            @if (CanReassess())
            {
                <MudTooltip Text="Reassess">
                    <MudIconButton Color="Color.Primary" Icon="@Icons.Material.Filled.Redo" Variant="Variant.Outlined" OnClick="BeginAssessment" />
                </MudTooltip>
            }
        </MudStack>
    </MudCardActions>
</MudCard>
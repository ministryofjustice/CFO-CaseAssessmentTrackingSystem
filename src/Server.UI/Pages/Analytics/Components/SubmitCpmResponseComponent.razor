@using Cfo.Cats.Application.Common.Validators
@using Cfo.Cats.Application.SecurityConstants
@using Cfo.Cats.Domain.Common.Enums

@attribute [Authorize(Policy = SecurityPolicies.OutcomeQualityDipVerification)]

@inject IAuthorizationService AuthorizationService
@inject AuthenticationStateProvider AuthenticationStateProvider

@if (Status != DipSampleStatus.Reviewed)
{
    <MudAlert Severity="Severity.Info">
        This information is now readonly because the sample is at the @Status.Name stage.
    </MudAlert>
}

<MudForm @ref="form" Model="Command" Validation="@(Validator.ValidateValue(Command))" Class="ma-2" ReadOnly="ReadOnly">
    <MudGrid>
        <MudItem xs="12" md="3">
            <MudText Typo="Typo.subtitle1">
                @Command.GetMemberDescription(x => x.Comments)
            </MudText>
        </MudItem>
        <MudItem xs="12" md="9" Class="d-flex align-center">
            <MudTextField @bind-Value="@Command.Comments"
                          For="@(() => Command.Comments)"
                          Lines="5"
                          MaxLength=@ValidationConstants.NotesLength
                          Counter=@ValidationConstants.NotesLength
                          Immediate="true">
            </MudTextField>
        </MudItem>

        <MudItem xs="12" md="8">
            <MudStack Row="true" AlignItems="AlignItems.Center">
                <MudAvatar Size="Size.Medium" Color="@Color.Primary">
                    ?
                </MudAvatar>
                <MudText Typo="Typo.subtitle1" id="participant-journey-label">
                    @Command.GetMemberDescription(x => x.ComplianceAnswer)
                </MudText>
            </MudStack>

        </MudItem>
        <MudItem xs="12" md="4" Class="d-flex align-center">
            <MudRadioGroup @bind-Value="Command.ComplianceAnswer" For="@(() => Command.ComplianceAnswer)">
                <MudRadio Value="@ComplianceAnswer.Compliant">@ComplianceAnswer.Compliant.Name</MudRadio>
                <MudRadio Value="@ComplianceAnswer.NotCompliant">@ComplianceAnswer.NotCompliant.Name</MudRadio>
                <MudRadio Value="@ComplianceAnswer.Unsure">@ComplianceAnswer.Unsure.Name</MudRadio>
            </MudRadioGroup>
        </MudItem>
        <MudItem xs="12">
            <MudButton Variant="Variant.Outlined" Color="Color.Primary" OnClick="OnSubmit">Submit</MudButton>
        </MudItem>
    </MudGrid>
</MudForm>

<style>
    .mud-table-cell-custom-group {
        font-weight: 500;
    }

    .mud-table-cell-custom-group-footer {
        padding-bottom: 50px;
        text-align: right;
    }
</style>

<MudItem xs="12">
    <MudCard style="height:100%">
        <MudCardHeader>
            <CardHeaderContent>
                <MudText Typo="Typo.h5">
                    Jobs
                </MudText>
                @if(_scheduler is not null)
                {
                    <MudAlert Severity="Severity.Info">
                        @GetSchedulerStatus()
                    </MudAlert>
                }
            </CardHeaderContent>
        </MudCardHeader>
        <MudCardContent>

            <MudTable 
                Items="JobDetails" 
                Hover="true" 
                Breakpoint="Breakpoint.Sm"
                GroupBy="@_groupDefinition"
                GroupHeaderStyle="background-color:var(--mud-palette-background-gray)">
                <HeaderContent>
                    <MudTh>Trigger</MudTh>
                    <MudTh>State</MudTh>
                    <MudTh>Next Scheduled</MudTh>
                    <MudTh>Last Scheduled</MudTh>
                </HeaderContent>
                <GroupHeaderTemplate>
                    <MudTh Class="mud-table-cell-custom-group" colspan="3">@context.Key: @context.Items.First().Description</MudTh>
                    <MudTh Class="mud-table-cell-custom-group">
                        <MudButton Disabled="@(_isTriggering || (_scheduler?.InStandbyMode ?? false))" Variant="Variant.Outlined" Color="Color.Primary" OnClick="() => TriggerJob(context.Key!.ToString()!)">
                            @if(_isTriggering)
                            {
                                <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true"/>
                                <MudText Class="ms-2">Triggering</MudText>
                            }
                            else
                            {
                                <MudText>Trigger</MudText>
                            }
                        </MudButton>
                    </MudTh>
                </GroupHeaderTemplate>
                <RowTemplate>
                    <MudTd DataLabel="Trigger">@context.TriggerDescription</MudTd>
                    <MudTd DataLabel="State">@context.TriggerState</MudTd>
                    <MudTd DataLabel="Next Scheduled">@context.NextFireTime</MudTd>
                    <MudTd DataLabel="Last Scheduled">@context.PreviousFireTime</MudTd>
                </RowTemplate>
            </MudTable>
        </MudCardContent>
        <MudCardActions>
            <MudButton Variant="Variant.Text" Color="Color.Warning" OnClick="() => PauseScheduler()" >Pause Scheduler</MudButton>
            <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="() => StartScheduler()" >Resume Scheduler</MudButton>
        </MudCardActions>
    </MudCard>
</MudItem>